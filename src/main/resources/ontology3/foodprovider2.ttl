# D2RQ Namespace  
@prefix d2rq: <http://www.wiwiss.fu-berlin.de/suhl/bizer/D2RQ/0.1#> .

# Namespace of the ontology
@prefix nutritionassessment: <http://www.semanticweb.org/dorin/ontologies/nutritionassessment#> .
@prefix nutritionmonitoring: <http://www.semanticweb.org/dorin/ontologies/nutritionmonitoring#> .
@prefix nutritiondiagnostic: <http://www.semanticweb.org/dorin/ontologies/nutritiondiagnostic#> .
@prefix food: <http://www.semanticweb.org/dorin/ontologies/food#> .
@prefix foodprovider: <http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#> .
@prefix nutritionassesment: <http://www.semanticweb.org/dorin/ontologies/nutritionassesment#> .

# Namespace of the mapping file; does not appear in mapped data
@prefix map: <#> .

# Other namespaces
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> . 
@prefix jdbc: <http://d2rq.org/terms/jdbc/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .

map:database a d2rq:Database;
    d2rq:jdbcDSN "jdbc:mysql://localhost/toateretetele";
    d2rq:jdbcDriver "com.mysql.jdbc.Driver";
    d2rq:username "cristiprg";
    d2rq:password "12345";
    jdbc:autoReconnect "true";
	jdbc:zeroDateTimeBehavior "convertToNull";
	.
	
##############################################################
##################MEAL TYPE###################################
##############################################################
	
# Table meal_type
map:meal_type a d2rq:ClassMap;
	d2rq:dataStorage map:database;
	d2rq:uriPattern "http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#@@meal_type.mealName@@";
	d2rq:class foodprovider:MealType;
	.

# Data Property mealTypeHasId
map:meal_type_mealId a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:meal_type;
    d2rq:property foodprovider:mealTypeHasId;
    d2rq:column "meal_type.mealId";
    d2rq:datatype xsd:integer;
	.
	
# Object property - subclass - MealType
map:meal_type_mealName a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:meal_type;
    d2rq:property rdf:type;
    d2rq:uriPattern "http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#@@meal_type.mealName@@";   
    .	
   
##############################################################
######################DISH TYPE###############################
##############################################################

# Table dish_type
map:dish_type a d2rq:ClassMap;
	d2rq:dataStorage map:database;
	d2rq:uriSqlExpression "CONCAT('http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#',REPLACE(dish_type.dishName,' ','_'))";
	d2rq:class foodprovider:Dish;
	.

# Data Property hasDishTypeId
map:dish_type_dishId a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:dish_type;
    d2rq:property foodprovider:dishHasId;
    d2rq:column "dish_type.dishId";
    d2rq:datatype xsd:integer;
	.
	
# Object property - subclass - DishType
map:dish_type_dishName a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:dish_type;
    d2rq:property rdf:type;
    d2rq:uriSqlExpression "CONCAT('http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#',REPLACE(dish_type.dishName,' ','_'))";
    .
    
    
##############################################################
#########################RECIPE###############################
##############################################################

# Table recipe
map:recipe a d2rq:ClassMap;
	d2rq:dataStorage map:database;
	d2rq:uriPattern "http://www.semanticweb.org/dorin/ontologies/nutritionassesment#Recipe@@recipe.recipeId@@";
	d2rq:class nutritionassesment:Recipe;
	.

# Data Property recipeHasId
map:recipe_recipeId a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:recipe;
    d2rq:property foodprovider:recipeHasId;
    d2rq:column "recipe.recipeId";
    d2rq:datatype xsd:integer;
	.	
	
# Data Property recipeHasName
map:recipe_name a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:recipe;
    d2rq:property foodprovider:recipeHasName;
    d2rq:column "recipe.name";
    d2rq:datatype xsd:string;
	.	
	
# Data Property recipeHasDescription
map:recipe_description a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:recipe;
    d2rq:property foodprovider:recipeHasDescription;
    d2rq:column "recipe.description";
    d2rq:datatype xsd:string;
	.

# Object Property recipeHasDishType
map:recipe_dishType a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasDishType;
	d2rq:refersToClassMap map:dish_type;
	d2rq:join "recipe.dishType => dish_type.dishId";
	.

# Data Property recipeHasNumberOfServings
map:recipe_numberOfServings a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:recipe;
    d2rq:property foodprovider:recipeHasNumberOfServings;
    d2rq:column "recipe.numberOfServings";
    d2rq:datatype xsd:integer;
	.

##############################################################
##############MEAL RECIPE RELATION############################
##############################################################

# table meal_recipe_relation
map:meal_recipe_relation a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasMealType;
	d2rq:refersToClassMap map:meal_type;
	d2rq:join "recipe.recipeId <= meal_recipe_relation.recipeId";
	d2rq:join "meal_recipe_relation.mealId =>meal_type.mealId";
	.
	
##############################################################
####################INGREDIENT################################
##############################################################

# Table food_descr
map:food_descr a d2rq:ClassMap;
	d2rq:dataStorage map:database;
	d2rq:uriPattern "http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#Ingredient@@food_descr.ndb_no@@"; 
	d2rq:class foodprovider:Ingredient;
	.

# Data Property ingredientHasId
map:food_descr_ndb_no a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:food_descr;
    d2rq:property foodprovider:ingredientHasId;
    d2rq:column "food_descr.ndb_no";
    d2rq:datatype xsd:string;
	.	
	
# Data Property ingredientHasName
map:food_descr_long_desc a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:food_descr;
    d2rq:property foodprovider:ingredientHasName;
    d2rq:column "food_descr.long_desc";
    d2rq:datatype xsd:string;
	.	
	
# Data Property hasFoodGroupCode
map:food_descr_food_group_code a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:food_descr;
    d2rq:property foodprovider:hasFoodGroupCode;
    d2rq:column "food_descr.food_group_code";
    d2rq:datatype xsd:string;
	.	
	
##############################################################
####################BASIC FOOD################################
##############################################################

# Table food_group_descr
map:food_group_descr a d2rq:ClassMap;
	d2rq:dataStorage map:database;
	d2rq:uriSqlExpression "CONCAT('http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#',REPLACE(food_group_descr.food_group_description,' ','_'))";
    d2rq:class nutritionassesment:BasicFood;
	.	
	
# Data Property hasFoodGroupCode
map:food_group_descr_food_group_code a d2rq:PropertyBridge;
    d2rq:belongsToClassMap map:food_group_descr;
    d2rq:property foodprovider:hasFoodGroupCode;
    d2rq:column "food_group_descr.food_group_code";
    d2rq:datatype xsd:string;
	.	
	
# Object property - subclass - BasicFood
map:food_group_descr_food_group_description a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:food_group_descr;
    d2rq:property rdf:type;
    d2rq:uriSqlExpression "CONCAT('http://www.semanticweb.org/linabarakat/ontologies/2014/8/foodprovider#',REPLACE(food_group_descr.food_group_description,' ','_'))";
    .
    
##############################################################
####################RELATION BASIC FOOD FOOD##################
##############################################################

# table relation_food_group_food
map:relation_food_group_food a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:food_descr;
	d2rq:property foodprovider:ingredientHasBasicFoodType;
	d2rq:refersToClassMap map:food_group_descr;
	d2rq:join "food_descr.ndb_no <= relation_food_group_food.ndb_no";
	d2rq:join "relation_food_group_food.food_group_code =>food_group_descr.food_group_code";
	.
	
##############################################################
####################RELATION NUTRIENT RECIPE##################
##############################################################

map:recipeHasProteins_g a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasProteins_g;
    d2rq:column "nutrient_recipe_relation.Proteins(g)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasFats_g a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasFats_g;
    d2rq:column "nutrient_recipe_relation.Lipids(g)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasCarbs_g a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasCarbs_g;
    d2rq:column "nutrient_recipe_relation.Carbohydrates(g)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasEnergy_kcal a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasEnergy_kcal;
    d2rq:column "nutrient_recipe_relation.Energy(kCal)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasIron_mg a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasIron_mg;
    d2rq:column "nutrient_recipe_relation.Iron(mg)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasSodium_mg a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasSodium_mg;
    d2rq:column "nutrient_recipe_relation.Sodium(mg)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasCalcium_mg a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasCalcium_mg;
    d2rq:column "nutrient_recipe_relation.Calcium(mg)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasVitaminA_ug a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasVitaminA_ug;
    d2rq:column "nutrient_recipe_relation.Vitamin_A(ug)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasVitaminD_ug a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasVitaminD_ug;
    d2rq:column "nutrient_recipe_relation.Vitamin_D(ug)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasVitaminC_mg a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasVitaminC_mg;
    d2rq:column "nutrient_recipe_relation.Vitamin_C(mg)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .
    
map:recipeHasVitaminB6_mg a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasVitaminB6_mg;
    d2rq:column "nutrient_recipe_relation.Vitamin_B6(mg)";
    d2rq:join "recipe.recipeId <= nutrient_recipe_relation.recipeId";
    d2rq:datatype xsd:double;
    .

##############################################################
##############INGREDIENT RECIPE RELATION######################
##############################################################

# table recipe_food_relation
map:recipe_food_relation a d2rq:PropertyBridge;
	d2rq:belongsToClassMap map:recipe;
	d2rq:property foodprovider:recipeHasIngredient;
	d2rq:refersToClassMap map:food_descr;
	d2rq:join "recipe.recipeId <= recipe_food_relation.recipeId";
	d2rq:join "recipe_food_relation.ndb_no =>food_descr.ndb_no";
	.